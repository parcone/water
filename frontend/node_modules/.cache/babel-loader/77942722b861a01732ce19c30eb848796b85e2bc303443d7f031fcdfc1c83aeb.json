{"ast":null,"code":"// webpack/vue-cli 环境下用 require.context\nconst requireImages = require.context('@/assets/water/photos', false, /\\\\.png$/);\nconst allImages = {};\nrequireImages.keys().forEach(key => {\n  const filename = key.replace('./', '');\n  allImages[`@/assets/water/photos/${filename}`] = requireImages(key);\n});\nexport default {\n  name: 'PhotoTimeline',\n  data() {\n    return {\n      photos: [],\n      currentIndex: 0,\n      isPlaying: false,\n      playSpeed: 2000,\n      playInterval: null,\n      isLoading: false\n    };\n  },\n  computed: {\n    currentPhoto() {\n      return this.photos[this.currentIndex] || null;\n    }\n  },\n  async mounted() {\n    await this.loadPhotos();\n  },\n  beforeUnmount() {\n    this.stopPlay();\n  },\n  methods: {\n    getImageUrl(path) {\n      if (!path) return '';\n      // 先尝试 src/assets/water/photos/xxx.png -> @/assets/water/photos/xxx.png\n      let key = path;\n      if (key.startsWith('src/assets/')) {\n        key = key.replace('src/assets/', '@/assets/');\n      }\n      // 兼容 @/assets/water/photos/xxx.png\n      if (allImages[key]) return allImages[key];\n      // 兼容只传文件名\n      const filename = path.split('/').pop();\n      key = `@/assets/water/photos/${filename}`;\n      return allImages[key] || '';\n    },\n    async loadPhotos() {\n      try {\n        this.isLoading = true;\n        const response = await fetch('/photos.json');\n        if (!response.ok) {\n          throw new Error('无法加载图片数据');\n        }\n        this.photos = await response.json();\n        console.log(`加载了 ${this.photos.length} 张图片`);\n      } catch (error) {\n        console.error('加载图片数据失败:', error);\n        this.$message?.error?.('加载图片数据失败') || alert('加载图片数据失败');\n      } finally {\n        this.isLoading = false;\n      }\n    },\n    onSliderChange(event) {\n      this.currentIndex = parseInt(event.target.value);\n      this.stopPlay();\n    },\n    playPause() {\n      if (this.isPlaying) {\n        this.stopPlay();\n      } else {\n        this.startPlay();\n      }\n    },\n    startPlay() {\n      if (this.photos.length === 0) return;\n      this.isPlaying = true;\n      this.playInterval = setInterval(() => {\n        this.currentIndex = (this.currentIndex + 1) % this.photos.length;\n      }, this.playSpeed);\n    },\n    stopPlay() {\n      this.isPlaying = false;\n      if (this.playInterval) {\n        clearInterval(this.playInterval);\n        this.playInterval = null;\n      }\n    },\n    updatePlaySpeed() {\n      if (this.isPlaying) {\n        this.stopPlay();\n        this.startPlay();\n      }\n    },\n    reset() {\n      this.stopPlay();\n      this.currentIndex = 0;\n    },\n    onImageLoad() {\n      console.log('图片加载成功');\n    },\n    onImageError() {\n      console.error('图片加载失败:', this.currentPhoto?.path);\n    }\n  }\n};","map":{"version":3,"names":["requireImages","require","context","allImages","keys","forEach","key","filename","replace","name","data","photos","currentIndex","isPlaying","playSpeed","playInterval","isLoading","computed","currentPhoto","mounted","loadPhotos","beforeUnmount","stopPlay","methods","getImageUrl","path","startsWith","split","pop","response","fetch","ok","Error","json","console","log","length","error","$message","alert","onSliderChange","event","parseInt","target","value","playPause","startPlay","setInterval","clearInterval","updatePlaySpeed","reset","onImageLoad","onImageError"],"sources":["D:\\restore\\water-melt\\frontend\\src\\components\\PhotoTimeline.vue"],"sourcesContent":["<template>\n  <div class=\"photo-timeline\">\n    <div class=\"timeline-header\">\n      <h2>图片时间轴</h2>\n      <div class=\"controls\">\n        <button @click=\"playPause\" class=\"control-btn\">\n          {{ isPlaying ? '⏸️ 暂停' : '▶️ 播放' }}\n        </button>\n        <button @click=\"reset\" class=\"control-btn\">🔄 重置</button>\n        <div class=\"speed-control\">\n          <label>速度:</label>\n          <select v-model=\"playSpeed\" @change=\"updatePlaySpeed\">\n            <option value=\"1000\">1秒</option>\n            <option value=\"2000\">2秒</option>\n            <option value=\"500\">0.5秒</option>\n            <option value=\"3000\">3秒</option>\n          </select>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"image-container\">\n      <div v-if=\"currentPhoto\" class=\"image-wrapper\">\n        <img \n          :src=\"getImageUrl(currentPhoto.path)\" \n          :alt=\"currentPhoto.displayName\"\n          class=\"timeline-image\"\n          @load=\"onImageLoad\"\n          @error=\"onImageError\"\n        />\n        <div class=\"image-info\">\n          <div class=\"date-info\">{{ currentPhoto.displayName }}</div>\n          <div class=\"progress-info\">{{ currentIndex + 1 }} / {{ photos.length }}</div>\n        </div>\n      </div>\n      <div v-else class=\"no-image\">\n        <p>暂无图片数据</p>\n      </div>\n    </div>\n\n    <div class=\"timeline-slider\">\n      <div class=\"slider-container\">\n        <input\n          type=\"range\"\n          :min=\"0\"\n          :max=\"photos.length - 1\"\n          :value=\"currentIndex\"\n          @input=\"onSliderChange\"\n          class=\"timeline-range\"\n          :disabled=\"photos.length === 0\"\n        />\n        <div class=\"slider-labels\">\n          <span v-if=\"photos.length > 0\">{{ photos[0]?.displayName }}</span>\n          <span v-if=\"photos.length > 0\">{{ photos[photos.length - 1]?.displayName }}</span>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"timeline-info\">\n      <div class=\"info-item\">\n        <span class=\"label\">当前时间:</span>\n        <span class=\"value\">{{ currentPhoto?.displayName || '无' }}</span>\n      </div>\n      <div class=\"info-item\">\n        <span class=\"label\">总图片数:</span>\n        <span class=\"value\">{{ photos.length }}</span>\n      </div>\n      <div class=\"info-item\">\n        <span class=\"label\">播放状态:</span>\n        <span class=\"value\">{{ isPlaying ? '播放中' : '已暂停' }}</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n// webpack/vue-cli 环境下用 require.context\nconst requireImages = require.context('@/assets/water/photos', false, /\\\\.png$/)\nconst allImages = {}\nrequireImages.keys().forEach(key => {\n  const filename = key.replace('./', '')\n  allImages[`@/assets/water/photos/${filename}`] = requireImages(key)\n})\n\nexport default {\n  name: 'PhotoTimeline',\n  data() {\n    return {\n      photos: [],\n      currentIndex: 0,\n      isPlaying: false,\n      playSpeed: 2000,\n      playInterval: null,\n      isLoading: false\n    }\n  },\n  computed: {\n    currentPhoto() {\n      return this.photos[this.currentIndex] || null\n    }\n  },\n  async mounted() {\n    await this.loadPhotos()\n  },\n  beforeUnmount() {\n    this.stopPlay()\n  },\n  methods: {\n    getImageUrl(path) {\n      if (!path) return ''\n      // 先尝试 src/assets/water/photos/xxx.png -> @/assets/water/photos/xxx.png\n      let key = path\n      if (key.startsWith('src/assets/')) {\n        key = key.replace('src/assets/', '@/assets/')\n      }\n      // 兼容 @/assets/water/photos/xxx.png\n      if (allImages[key]) return allImages[key]\n      // 兼容只传文件名\n      const filename = path.split('/').pop()\n      key = `@/assets/water/photos/${filename}`\n      return allImages[key] || ''\n    },\n    async loadPhotos() {\n      try {\n        this.isLoading = true\n        const response = await fetch('/photos.json')\n        if (!response.ok) {\n          throw new Error('无法加载图片数据')\n        }\n        this.photos = await response.json()\n        console.log(`加载了 ${this.photos.length} 张图片`)\n      } catch (error) {\n        console.error('加载图片数据失败:', error)\n        this.$message?.error?.('加载图片数据失败') || alert('加载图片数据失败')\n      } finally {\n        this.isLoading = false\n      }\n    },\n    \n    onSliderChange(event) {\n      this.currentIndex = parseInt(event.target.value)\n      this.stopPlay()\n    },\n    \n    playPause() {\n      if (this.isPlaying) {\n        this.stopPlay()\n      } else {\n        this.startPlay()\n      }\n    },\n    \n    startPlay() {\n      if (this.photos.length === 0) return\n      \n      this.isPlaying = true\n      this.playInterval = setInterval(() => {\n        this.currentIndex = (this.currentIndex + 1) % this.photos.length\n      }, this.playSpeed)\n    },\n    \n    stopPlay() {\n      this.isPlaying = false\n      if (this.playInterval) {\n        clearInterval(this.playInterval)\n        this.playInterval = null\n      }\n    },\n    \n    updatePlaySpeed() {\n      if (this.isPlaying) {\n        this.stopPlay()\n        this.startPlay()\n      }\n    },\n    \n    reset() {\n      this.stopPlay()\n      this.currentIndex = 0\n    },\n    \n    onImageLoad() {\n      console.log('图片加载成功')\n    },\n    \n    onImageError() {\n      console.error('图片加载失败:', this.currentPhoto?.path)\n    }\n  }\n}\n</script>\n\n<style scoped>\n.photo-timeline {\n  max-width: 1200px;\n  margin: 0 auto;\n  padding: 20px;\n  background: #f8f9fa;\n  border-radius: 12px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\n.timeline-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n  padding-bottom: 15px;\n  border-bottom: 2px solid #e9ecef;\n}\n\n.timeline-header h2 {\n  margin: 0;\n  color: #2c3e50;\n  font-size: 24px;\n  font-weight: 600;\n}\n\n.controls {\n  display: flex;\n  gap: 15px;\n  align-items: center;\n}\n\n.control-btn {\n  padding: 8px 16px;\n  border: none;\n  border-radius: 6px;\n  background: #007bff;\n  color: white;\n  cursor: pointer;\n  font-size: 14px;\n  transition: background-color 0.3s;\n}\n\n.control-btn:hover {\n  background: #0056b3;\n}\n\n.speed-control {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.speed-control label {\n  font-size: 14px;\n  color: #6c757d;\n}\n\n.speed-control select {\n  padding: 4px 8px;\n  border: 1px solid #ced4da;\n  border-radius: 4px;\n  background: white;\n}\n\n.image-container {\n  margin-bottom: 20px;\n  text-align: center;\n}\n\n.image-wrapper {\n  position: relative;\n  display: inline-block;\n  max-width: 100%;\n}\n\n.timeline-image {\n  max-width: 100%;\n  max-height: 500px;\n  border-radius: 8px;\n  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);\n  transition: transform 0.3s ease;\n}\n\n.timeline-image:hover {\n  transform: scale(1.02);\n}\n\n.image-info {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: rgba(0, 0, 0, 0.7);\n  color: white;\n  padding: 10px;\n  border-radius: 0 0 8px 8px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.date-info {\n  font-weight: 600;\n  font-size: 16px;\n}\n\n.progress-info {\n  font-size: 14px;\n  opacity: 0.9;\n}\n\n.no-image {\n  padding: 60px 20px;\n  color: #6c757d;\n  font-size: 18px;\n}\n\n.timeline-slider {\n  margin-bottom: 20px;\n}\n\n.slider-container {\n  position: relative;\n}\n\n.timeline-range {\n  width: 100%;\n  height: 8px;\n  border-radius: 4px;\n  background: #e9ecef;\n  outline: none;\n  cursor: pointer;\n  -webkit-appearance: none;\n}\n\n.timeline-range::-webkit-slider-thumb {\n  -webkit-appearance: none;\n  appearance: none;\n  width: 20px;\n  height: 20px;\n  border-radius: 50%;\n  background: #007bff;\n  cursor: pointer;\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);\n}\n\n.timeline-range::-moz-range-thumb {\n  width: 20px;\n  height: 20px;\n  border-radius: 50%;\n  background: #007bff;\n  cursor: pointer;\n  border: none;\n  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);\n}\n\n.slider-labels {\n  display: flex;\n  justify-content: space-between;\n  margin-top: 8px;\n  font-size: 12px;\n  color: #6c757d;\n}\n\n.timeline-info {\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n  gap: 15px;\n  padding: 15px;\n  background: white;\n  border-radius: 8px;\n  border: 1px solid #e9ecef;\n}\n\n.info-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.label {\n  font-weight: 600;\n  color: #495057;\n}\n\n.value {\n  color: #007bff;\n  font-weight: 500;\n}\n\n@media (max-width: 768px) {\n  .timeline-header {\n    flex-direction: column;\n    gap: 15px;\n    align-items: stretch;\n  }\n  \n  .controls {\n    justify-content: center;\n    flex-wrap: wrap;\n  }\n  \n  .timeline-info {\n    grid-template-columns: 1fr;\n  }\n}\n</style> "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}