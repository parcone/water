{"ast":null,"code":"import { createElementVNode as _createElementVNode, createVNode as _createVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"base-map-container\"\n};\nconst _hoisted_2 = {\n  ref: \"mapContainer\",\n  class: \"map-container\"\n};\nconst _hoisted_3 = {\n  key: 0,\n  class: \"map-overlay\"\n};\nconst _hoisted_4 = {\n  class: \"map-controls\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_el_icon = _resolveComponent(\"el-icon\");\n  const _component_el_button = _resolveComponent(\"el-button\");\n  const _component_el_button_group = _resolveComponent(\"el-button-group\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, null, 512 /* NEED_PATCH */), $setup.loading ? (_openBlock(), _createElementBlock(\"div\", _hoisted_3, [_createVNode(_component_el_icon, {\n    class: \"is-loading\"\n  }, {\n    default: _withCtx(() => [_createVNode($setup[\"Loading\"])]),\n    _: 1 /* STABLE */\n  })])) : _createCommentVNode(\"v-if\", true), _createElementVNode(\"div\", _hoisted_4, [_createVNode(_component_el_button_group, null, {\n    default: _withCtx(() => [_createVNode(_component_el_button, {\n      icon: $setup.Plus,\n      onClick: _cache[0] || (_cache[0] = $event => $setup.handleZoom(1)),\n      circle: \"\"\n    }, null, 8 /* PROPS */, [\"icon\"]), _createVNode(_component_el_button, {\n      icon: $setup.Minus,\n      onClick: _cache[1] || (_cache[1] = $event => $setup.handleZoom(-1)),\n      circle: \"\"\n    }, null, 8 /* PROPS */, [\"icon\"])]),\n    _: 1 /* STABLE */\n  })])]);\n}","map":{"version":3,"names":["class","ref","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","$setup","loading","_hoisted_3","_createVNode","_component_el_icon","_hoisted_4","_component_el_button_group","_component_el_button","icon","Plus","onClick","_cache","$event","handleZoom","circle","Minus"],"sources":["D:\\restore\\water-melt\\frontend\\src\\components\\BaseMap.vue"],"sourcesContent":["<!-- 基础地图组件 -->\r\n<template>\r\n  <div class=\"base-map-container\">\r\n    <div ref=\"mapContainer\" class=\"map-container\"></div>\r\n    <div class=\"map-overlay\" v-if=\"loading\">\r\n      <el-icon class=\"is-loading\"><Loading /></el-icon>\r\n    </div>\r\n    <div class=\"map-controls\">\r\n      <el-button-group>\r\n        <el-button :icon=\"Plus\" @click=\"handleZoom(1)\" circle></el-button>\r\n        <el-button :icon=\"Minus\" @click=\"handleZoom(-1)\" circle></el-button>\r\n      </el-button-group>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, onMounted, onUnmounted } from 'vue'\r\nimport { Plus, Minus, Loading } from '@element-plus/icons-vue'\r\nimport * as L from 'leaflet'\r\nimport 'leaflet/dist/leaflet.css'\r\n\r\nconst props = defineProps({\r\n  center: {\r\n    type: Array,\r\n    default: () => [39.916527, 116.397128] // 默认北京中心坐标\r\n  },\r\n  zoom: {\r\n    type: Number,\r\n    default: 13\r\n  },\r\n  markers: {\r\n    type: Array,\r\n    default: () => []\r\n  }\r\n})\r\n\r\nconst emit = defineEmits(['marker-click', 'map-ready'])\r\n\r\nconst mapContainer = ref(null)\r\nconst loading = ref(true)\r\nlet map = null\r\n\r\n// 初始化地图\r\nonMounted(async () => {\r\n  if (!mapContainer.value) return\r\n\r\n  // 创建地图实例\r\n  map = L.map(mapContainer.value, {\r\n    center: props.center,\r\n    zoom: props.zoom,\r\n    zoomControl: false\r\n  })\r\n\r\n  // 添加图层\r\n  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n    attribution: '© OpenStreetMap contributors'\r\n  }).addTo(map)\r\n\r\n  // 添加标记\r\n  updateMarkers()\r\n\r\n  loading.value = false\r\n  emit('map-ready', map)\r\n})\r\n\r\n// 更新标记\r\nconst updateMarkers = () => {\r\n  if (!map) return\r\n\r\n  // 清除现有标记\r\n  map.eachLayer((layer) => {\r\n    if (layer instanceof L.Marker) {\r\n      map.removeLayer(layer)\r\n    }\r\n  })\r\n\r\n  // 添加新标记\r\n  props.markers.forEach(marker => {\r\n    const { position, icon, popup } = marker\r\n    \r\n    const markerInstance = L.marker(position, {\r\n      icon: icon ? L.icon(icon) : undefined\r\n    }).addTo(map)\r\n\r\n    if (popup) {\r\n      markerInstance.bindPopup(popup)\r\n    }\r\n\r\n    markerInstance.on('click', () => {\r\n      emit('marker-click', marker)\r\n    })\r\n  })\r\n}\r\n\r\n// 缩放控制\r\nconst handleZoom = (delta) => {\r\n  if (!map) return\r\n  map.setZoom(map.getZoom() + delta)\r\n}\r\n\r\n// 组件销毁时清理\r\nonUnmounted(() => {\r\n  if (map) {\r\n    map.remove()\r\n    map = null\r\n  }\r\n})\r\n\r\n// 监听属性变化\r\nwatch(() => props.markers, updateMarkers, { deep: true })\r\nwatch(() => props.center, (newCenter) => {\r\n  if (map) {\r\n    map.setView(newCenter, map.getZoom())\r\n  }\r\n})\r\nwatch(() => props.zoom, (newZoom) => {\r\n  if (map) {\r\n    map.setZoom(newZoom)\r\n  }\r\n})\r\n</script>\r\n\r\n<style scoped>\r\n.base-map-container {\r\n  position: relative;\r\n  width: 100%;\r\n  height: 100%;\r\n  min-height: 400px;\r\n  border-radius: 8px;\r\n  overflow: hidden;\r\n  background: #f5f7fa;\r\n}\r\n\r\n.map-container {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.map-overlay {\r\n  position: absolute;\r\n  top: 0;\r\n  left: 0;\r\n  right: 0;\r\n  bottom: 0;\r\n  background: rgba(255, 255, 255, 0.8);\r\n  display: flex;\r\n  justify-content: center;\r\n  align-items: center;\r\n  z-index: 1000;\r\n}\r\n\r\n.map-controls {\r\n  position: absolute;\r\n  bottom: 20px;\r\n  right: 20px;\r\n  z-index: 1000;\r\n}\r\n\r\n:deep(.leaflet-container) {\r\n  background: #f5f7fa;\r\n}\r\n\r\n:deep(.leaflet-control-attribution) {\r\n  background: rgba(255, 255, 255, 0.8);\r\n  padding: 0 5px;\r\n  border-radius: 4px;\r\n}\r\n</style> "],"mappings":";;EAEOA,KAAK,EAAC;AAAoB;;EACxBC,GAAG,EAAC,cAAc;EAACD,KAAK,EAAC;;;;EACzBA,KAAK,EAAC;;;EAGNA,KAAK,EAAC;AAAc;;;;;uBAL3BE,mBAAA,CAWM,OAXNC,UAWM,GAVJC,mBAAA,CAAoD,OAApDC,UAAoD,+BACrBC,MAAA,CAAAC,OAAO,I,cAAtCL,mBAAA,CAEM,OAFNM,UAEM,GADJC,YAAA,CAAiDC,kBAAA;IAAxCV,KAAK,EAAC;EAAY;sBAAC,MAAW,CAAXS,YAAA,CAAWH,MAAA,a;;6CAEzCF,mBAAA,CAKM,OALNO,UAKM,GAJJF,YAAA,CAGkBG,0BAAA;sBAFhB,MAAkE,CAAlEH,YAAA,CAAkEI,oBAAA;MAAtDC,IAAI,EAAER,MAAA,CAAAS,IAAI;MAAGC,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEZ,MAAA,CAAAa,UAAU;MAAKC,MAAM,EAAN;uCAC/CX,YAAA,CAAoEI,oBAAA;MAAxDC,IAAI,EAAER,MAAA,CAAAe,KAAK;MAAGL,OAAK,EAAAC,MAAA,QAAAA,MAAA,MAAAC,MAAA,IAAEZ,MAAA,CAAAa,UAAU;MAAMC,MAAM,EAAN","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}