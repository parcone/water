{"ast":null,"code":"import { ref, onMounted, onBeforeUnmount, watch } from 'vue';\nimport * as echarts from 'echarts';\nimport { debounce } from 'lodash-es';\nexport default {\n  name: 'BaseEChart',\n  props: {\n    options: {\n      type: Object,\n      required: true\n    },\n    width: {\n      type: String,\n      default: '100%'\n    },\n    height: {\n      type: String,\n      default: '100%'\n    },\n    theme: {\n      type: String,\n      default: ''\n    }\n  },\n  emits: ['chartReady'],\n  setup(props, {\n    emit\n  }) {\n    const chartRef = ref(null);\n    let chart = null;\n\n    // 初始化图表\n    const initChart = () => {\n      if (!chartRef.value) return;\n      chart = echarts.init(chartRef.value, props.theme);\n      chart.setOption(props.options);\n      emit('chartReady', chart);\n\n      // 监听窗口大小变化\n      window.addEventListener('resize', handleResize);\n    };\n\n    // 防抖处理窗口大小变化\n    const handleResize = debounce(() => {\n      chart && chart.resize();\n    }, 100);\n\n    // 更新图表选项\n    const updateChart = () => {\n      if (!chart) return;\n      chart.setOption(props.options);\n    };\n\n    // 监听选项变化\n    watch(() => props.options, () => {\n      updateChart();\n    }, {\n      deep: true\n    });\n\n    // 生命周期钩子\n    onMounted(() => {\n      initChart();\n    });\n    onBeforeUnmount(() => {\n      if (!chart) return;\n      window.removeEventListener('resize', handleResize);\n      chart.dispose();\n      chart = null;\n    });\n    return {\n      chartRef\n    };\n  }\n};","map":{"version":3,"names":["ref","onMounted","onBeforeUnmount","watch","echarts","debounce","name","props","options","type","Object","required","width","String","default","height","theme","emits","setup","emit","chartRef","chart","initChart","value","init","setOption","window","addEventListener","handleResize","resize","updateChart","deep","removeEventListener","dispose"],"sources":["D:\\restore\\water-melt\\frontend\\src\\components\\BaseEChart.vue"],"sourcesContent":["<!-- ECharts基础组件 -->\r\n<template>\r\n  <div \r\n    ref=\"chartRef\" \r\n    :style=\"{ \r\n      width: width, \r\n      height: height,\r\n      minHeight: '300px'\r\n    }\"\r\n  ></div>\r\n</template>\r\n\r\n<script>\r\nimport { ref, onMounted, onBeforeUnmount, watch } from 'vue'\r\nimport * as echarts from 'echarts'\r\nimport { debounce } from 'lodash-es'\r\n\r\nexport default {\r\n  name: 'BaseEChart',\r\n  props: {\r\n    options: {\r\n      type: Object,\r\n      required: true\r\n    },\r\n    width: {\r\n      type: String,\r\n      default: '100%'\r\n    },\r\n    height: {\r\n      type: String,\r\n      default: '100%'\r\n    },\r\n    theme: {\r\n      type: String,\r\n      default: ''\r\n    }\r\n  },\r\n  emits: ['chartReady'],\r\n  setup(props, { emit }) {\r\n    const chartRef = ref(null)\r\n    let chart = null\r\n\r\n    // 初始化图表\r\n    const initChart = () => {\r\n      if (!chartRef.value) return\r\n      \r\n      chart = echarts.init(chartRef.value, props.theme)\r\n      chart.setOption(props.options)\r\n      emit('chartReady', chart)\r\n\r\n      // 监听窗口大小变化\r\n      window.addEventListener('resize', handleResize)\r\n    }\r\n\r\n    // 防抖处理窗口大小变化\r\n    const handleResize = debounce(() => {\r\n      chart && chart.resize()\r\n    }, 100)\r\n\r\n    // 更新图表选项\r\n    const updateChart = () => {\r\n      if (!chart) return\r\n      chart.setOption(props.options)\r\n    }\r\n\r\n    // 监听选项变化\r\n    watch(\r\n      () => props.options,\r\n      () => {\r\n        updateChart()\r\n      },\r\n      { deep: true }\r\n    )\r\n\r\n    // 生命周期钩子\r\n    onMounted(() => {\r\n      initChart()\r\n    })\r\n\r\n    onBeforeUnmount(() => {\r\n      if (!chart) return\r\n      window.removeEventListener('resize', handleResize)\r\n      chart.dispose()\r\n      chart = null\r\n    })\r\n\r\n    return {\r\n      chartRef\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n/* 确保容器有最小高度 */\r\ndiv {\r\n  min-height: 300px;\r\n}\r\n</style> "],"mappings":"AAaA,SAASA,GAAG,EAAEC,SAAS,EAAEC,eAAe,EAAEC,KAAI,QAAS,KAAI;AAC3D,OAAO,KAAKC,OAAM,MAAO,SAAQ;AACjC,SAASC,QAAO,QAAS,WAAU;AAEnC,eAAe;EACbC,IAAI,EAAE,YAAY;EAClBC,KAAK,EAAE;IACLC,OAAO,EAAE;MACPC,IAAI,EAAEC,MAAM;MACZC,QAAQ,EAAE;IACZ,CAAC;IACDC,KAAK,EAAE;MACLH,IAAI,EAAEI,MAAM;MACZC,OAAO,EAAE;IACX,CAAC;IACDC,MAAM,EAAE;MACNN,IAAI,EAAEI,MAAM;MACZC,OAAO,EAAE;IACX,CAAC;IACDE,KAAK,EAAE;MACLP,IAAI,EAAEI,MAAM;MACZC,OAAO,EAAE;IACX;EACF,CAAC;EACDG,KAAK,EAAE,CAAC,YAAY,CAAC;EACrBC,KAAKA,CAACX,KAAK,EAAE;IAAEY;EAAK,CAAC,EAAE;IACrB,MAAMC,QAAO,GAAIpB,GAAG,CAAC,IAAI;IACzB,IAAIqB,KAAI,GAAI,IAAG;;IAEf;IACA,MAAMC,SAAQ,GAAIA,CAAA,KAAM;MACtB,IAAI,CAACF,QAAQ,CAACG,KAAK,EAAE;MAErBF,KAAI,GAAIjB,OAAO,CAACoB,IAAI,CAACJ,QAAQ,CAACG,KAAK,EAAEhB,KAAK,CAACS,KAAK;MAChDK,KAAK,CAACI,SAAS,CAAClB,KAAK,CAACC,OAAO;MAC7BW,IAAI,CAAC,YAAY,EAAEE,KAAK;;MAExB;MACAK,MAAM,CAACC,gBAAgB,CAAC,QAAQ,EAAEC,YAAY;IAChD;;IAEA;IACA,MAAMA,YAAW,GAAIvB,QAAQ,CAAC,MAAM;MAClCgB,KAAI,IAAKA,KAAK,CAACQ,MAAM,CAAC;IACxB,CAAC,EAAE,GAAG;;IAEN;IACA,MAAMC,WAAU,GAAIA,CAAA,KAAM;MACxB,IAAI,CAACT,KAAK,EAAE;MACZA,KAAK,CAACI,SAAS,CAAClB,KAAK,CAACC,OAAO;IAC/B;;IAEA;IACAL,KAAK,CACH,MAAMI,KAAK,CAACC,OAAO,EACnB,MAAM;MACJsB,WAAW,CAAC;IACd,CAAC,EACD;MAAEC,IAAI,EAAE;IAAK,CACf;;IAEA;IACA9B,SAAS,CAAC,MAAM;MACdqB,SAAS,CAAC;IACZ,CAAC;IAEDpB,eAAe,CAAC,MAAM;MACpB,IAAI,CAACmB,KAAK,EAAE;MACZK,MAAM,CAACM,mBAAmB,CAAC,QAAQ,EAAEJ,YAAY;MACjDP,KAAK,CAACY,OAAO,CAAC;MACdZ,KAAI,GAAI,IAAG;IACb,CAAC;IAED,OAAO;MACLD;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}